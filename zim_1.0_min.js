// ZIM js Interactive Media modules by Dan Zen http://danzen.com (c) 2014
// zim.js includes all the basic zim coding modules http://zimjs.com
// free to use - donations welcome of course! http://zimjs.com/donate

function zid(e){return document.getElementById(e)}function zss(e){return document.getElementById(e).style}function zgo(e,t){if(zot(t)){window.location.href=e}else{window.open(e,"_blank","modal=yes,alwaysRaised=yes")}}function zum(e){return Number(e.replace(/[^\d\.\-]/g,""))}function zot(e){if(e===null)return true;return typeof e==="undefined"}function zop(e){if(e.stopImmediatePropagation)e.stopImmediatePropagation();if(window.event)window.event.cancelBubble=true}if(typeof zon==="undefined")zon=false;var zog=console.log.bind(console);if(zon)zog("ZIM WRAP - zog, zid, zss, zgo, zum, zot, zop");var zim=function(e){if(zon)zog("ZIM CODE Module");e.shuffle=function(e){var t=e.length,n,r;if(t==0)return e;while(--t){n=Math.floor(Math.random()*(t+1));r=e[t];e[t]=e[n];e[n]=r}return e};e.rand=function(e,t,n){if(zot(n))n=true;if(zot(t))t=0;if(zot(e))e=0;if(e>t){e++}else if(t>e){t++}var r;if(e==0&&t==0){return Math.random()}else if(t==0){r=Math.random()*e}else{r=Math.min(e,t)+Math.random()*(Math.max(e,t)-Math.min(e,t))}if(n){return Math.floor(r)}else{return r}};e.decimals=function(e,t){if(zot(e)||e==0)return 0;if(zot(t))t=1;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};return e}(zim||{});var zim=function(e){if(zon)zog("ZIM DOM Module");e.scrollY=function(){var e=0;var t=navigator.appName;var n=navigator.userAgent.indexOf("Safari");if(n!=-1||t=="Safari"){var e=1}if(!e&&document.compatMode=="CSS1Compat"){return document.documentElement.scrollTop}else{return document.body.scrollTop}};e.windowWidth=function(){return isNaN(window.innerWidth)?window.clientWidth:window.innerWidth};e.windowHeight=function(){return isNaN(window.innerHeight)?window.clientHeight:window.innerHeight};e.urlEncode=function(e){var e=(e+"").toString();return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")};e.urlDecode=function(e){return decodeURIComponent((e+"").replace(/\+/g,"%20"))};e.setCookie=function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else{var i=""}document.cookie=e+"="+escape(t)+i+"; path=/"};e.getCookie=function(e){var t=document.cookie.split(/;\s*/);var n=new Array;var r;for(i=0;i<t.length;i++){r=t[i].split("=");n[r[0]]=r[1]}return unescape(n[e])};e.deleteCookie=function(t){e.setCookie(t,"",-1)};return e}(zim||{});var zim=function(e){if(zon)zog("ZIM CREATE Module");e.drag=function(e,t,n,r){function u(e,t,n){var r=e.parent.globalToLocal(t,n);var o=a(r.x-i,r.y-s);e.x=o.x;e.y=o.y;e.getStage().update()}function a(n,r){if(t){var i=e.parent.localToGlobal(n,r);n=Math.max(t.x,Math.min(t.x+t.width,i.x));r=Math.max(t.y,Math.min(t.y+t.height,i.y));i=e.parent.globalToLocal(n,r);n=i.x;r=i.y}return{x:n,y:r}}if(!e.parent){zog("zimcreate.js  drag(): Object must be added to stage at start to drag");return}e.cursor=zot(n)?"pointer":n;var i=0;var s=0;var o=e.parent.localToGlobal(e.x,e.y);u(e,o.x,o.y);e.zimDown=e.on("mousedown",function(t){var n=t.target.parent.globalToLocal(t.stageX,t.stageY);i=n.x-t.target.x;s=n.y-t.target.y;e.cursor=zot(r)?"move":r},true);e.zimMove=e.on("pressmove",function(e){u(e.target,e.stageX,e.stageY)},true);e.zimUp=e.on("pressup",function(t){e.cursor=zot(n)?"pointer":n},true)};e.noDrag=function(e){e.cursor="default";e.off("mousedown",e.zimDown);e.off("pressmove",e.zimMove);e.off("pressup",e.zimUp)};e.hitTestPoint=function(e,t,n){var r=e.globalToLocal(t,n);return e.hitTest(r.x,r.y)};e.hitTestReg=function(e,t){var n=t.localToLocal(t.regX,t.regY,e);return e.hitTest(n.x,n.y)};e.hitTestRect=function(e,t,n){if(zot(n))n=0;var r=t.getBounds();if(!r)if(zon){zog("zimcreate.js hitTestRect:\n please setBounds() on param b object");return}var i,s,o;for(var u=0;u<=n;u++){i=r.width*(u+1)/(n+1);s=r.height*(u+1)/(n+1);o=t.localToLocal(r.x+i,r.y,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x+r.width,r.y+s,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x+r.width-i,r.y+r.height,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x,r.y+r.height-s,e);if(e.hitTest(o.x,o.y))return true}};e.hitTestCircle=function(e,t,n){if(zot(n))n=8;var r=t.getBounds();if(!r)if(zon){zog("zimcreate.js hitTestCircle:\n please setBounds() on param b object");return}var i=r.x+r.width/2;var s=r.y+r.height/2;var o=(r.width+r.height)/2/2;var u,a,f,l;for(var c=0;c<n;c++){u=c/n*2*Math.PI;a=i+o*Math.cos(u);f=s+o*Math.sin(u);l=t.localToLocal(a,f,e);if(e.hitTest(l.x,l.y))return true}};e.hitTestBounds=function(t,n,r){function l(e,t){if(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y){return false}else{return true}}var i=false;if(r&&r.graphics)i=true;var s=t.getBounds();var o=n.getBounds();if(!s||!o)if(zon){zog("zimcreate.js hitTestBounds:\n please setBounds() on both objects");return}var u=e.boundsToGlobal(t);var a=e.boundsToGlobal(n);if(i){var f=r.graphics;f.clear();f.setStrokeStyle(1).beginStroke("blue");f.drawRect(u.x,u.y,u.width,u.height);f.beginStroke("green");f.drawRect(a.x,a.y,a.width,a.height);r.getStage().update()}return l(u,a)};e.boundsToGlobal=function(e){var t=e.getBounds();if(!t)if(zon){zog("zimcreate.js boundsToGlobal:\n please setBounds() on both object");return}var n=e.localToGlobal(t.x,t.y);var r=e.localToGlobal(t.x+t.width,t.y);var i=e.localToGlobal(t.x+t.width,t.y+t.height);var s=e.localToGlobal(t.x,t.y+t.height);var o=Math.min(n.x,r.x,i.x,s.x);var u=Math.min(n.y,r.y,i.y,s.y);var a=Math.max(n.x,r.x,i.x,s.x);var f=Math.max(n.y,r.y,i.y,s.y);return new createjs.Rectangle(o,u,a-o,f-u)};e.scale=function(e,t){if(zot(e))return;if(zot(t))t=1;e.scaleX=e.scaleY=t};return e}(zim||{});var zim=function(e){if(zon)zog("ZIM BUILD Module");e.Button=function(t,n,r,i,s,o,u,a,f,l,c,h,p){function d(){function g(r){m.on("mouseout",y);var i=e.graphics;i.clear();i.f(u);if(l)i.s(l);i.rr(0,0,t,n,c);v.color=f;stage.update()}function y(r){m.off("mouseout",y);var i=e.graphics;i.clear();i.f(o);if(l)i.s(l);i.rr(0,0,t,n,c);v.color=a;stage.update()}if(zon)zog("zimbuild.js: Button");if(zot(t))t=200;if(zot(n))n=60;if(zot(r))r="PRESS";if(zot(i))i=36;if(zot(s))s="arial";if(zot(o))o="#C60";if(zot(u))u="#F93";if(zot(a))a="white";if(zot(f))f="white";if(zot(l))l="#777";if(zot(c))c=20;if(zot(h))h="#666";if(zot(p))p=16;this.mouseChildren=false;this.cursor="pointer";var e=new createjs.Shape;var d=e.graphics;d.f(o);if(l)d.s(l);d.rr(0,0,t,n,c);this.addChild(e);if(p>0)e.shadow=new createjs.Shadow(h,3,3,p);this.setBounds(0,0,t,n);var v=new createjs.Text(r,i+"px "+s,a);v.textBaseline="middle";v.textAlign="center";v.x=t/2+1;v.y=n/2+2;this.addChild(v);this.buttonLable=v;this.on("mouseover",g);var m=this}d.prototype=new createjs.Container;d.constructor=e.Button;return new d};e.Pane=function(t,n,r,i,s,o,u,a,f){function l(){function v(e,i){e=Math.max(0,Math.min(t.canvas.width-n,e));i=Math.max(0,Math.min(t.canvas.height-r,i));return{x:e,y:i}}if(zon)zog("zimbuild.js: Pane");if(zot(t))if(zon){zog("Please pass in a reference to the stage as first parameter");return}if(zot(n))n=200;if(zot(r))r=200;if(zot(i))n="white";if(zot(s))s=false;if(zot(o))o=false;if(zot(u))u=true;if(zot(a))a=20;if(zot(f))f=.14;var e=this.backing=new createjs.Shape;var l=e.graphics;l.beginFill("black");l.drawRect(-5e3,-5e3,1e4,1e4);e.alpha=f;var c=this;e.on("click",function(e){c.hide()});if(u)this.addChild(e);var h=this.display=new createjs.Shape;l=h.graphics;l.beginFill(i);l.drawRoundRect(0,0,n,r,a);h.shadow=new createjs.Shadow("#333",8,8,20);h.on("click",function(e){e.stopImmediatePropagation()});this.resetX;this.resetY;if(s){h.cursor="pointer";var p,d;h.on("mousedown",function(e){if(isNaN(c.resetX))c.resetX=c.x;if(isNaN(c.resetY))c.resetY=c.y;p=e.stageX-c.x;d=e.stageY-c.y;h.cursor="move"});h.on("pressmove",function(e){var n=v(e.stageX-p,e.stageY-d);c.x=n.x;c.y=n.y;t.update()});this.on("pressup",function(e){h.cursor="pointer"})}this.addChild(h);this.x=(t.canvas.width-n)/2;this.y=(t.canvas.height-r)/2;this.setBounds(0,0,n,r);t.update();this.hide=function(){t.removeChild(this);t.update();if(o){if(!isNaN(c.resetX))c.x=c.resetX;if(!isNaN(c.resetY))c.y=c.resetY}};this.show=function(){t.addChild(this);t.update()}}l.prototype=new createjs.Container;l.constructor=e.Pane;return new l};e.Parallax=function(t,n,r){function l(e){var n;var r;var i;var s;for(var o=0;o<u.length;o++){n=u[o];s=n.parent.localToGlobal(n.zimsX,n.zimsY);r=s.x;i=s.y;if(n.zimX!=0){r=r-n.zimX/2+n.zimpX.convert(t.mouseX)}if(n.zimY!=0){i=i-n.zimY/2+n.zimpY.convert(t.mouseY)}s=n.parent.globalToLocal(r,i);n.x=s.x;n.y=s.y}t.update()}if(zon)zog("zimbuild.js: Parallax");if(zot(t))if(zon){zog("please pass in the stage");return}var i=t.canvas.width;var s=t.canvas.height;var o=this;this.damp=zot(n)?.1:n;this.addLayer=function(t,n,r){if(zot(t))return;t.zimX=zot(n)?0:n;t.zimY=zot(r)?0:r;if(t.zimX!=0){t.zimpX=new e.ProportionDamp(0,i,0,t.zimX,o.damp)}if(t.zimY!=0){t.zimpY=new e.ProportionDamp(0,s,0,t.zimY,o.damp)}t.zimsX=t.x;t.zimsY=t.y;u.push(t)};this.dispose=function(){u=null;createjs.Ticker.off("tick",f)};r=zot(r)?[]:r;var u=[];for(var a=0;a<r.length;a++){this.addLayer(r[a][0],r[a][1],r[a][2])}var f=createjs.Ticker.on("tick",l);createjs.Ticker.setFPS(60)};e.Scroller=function(e,t,n,r,i){function f(n){if(s.speed==0||s.direction==0){return}if(i){e.x-=s.speed*s.direction;t.x-=s.speed*s.direction;if(s.direction*s.speed>0){if(t.x<0&&e.x<t.x){e.x=t.getBounds().width}else if(e.x<0&&t.x<e.x){t.x=e.getBounds().width}}else{if(t.x>o&&t.x>e.x){t.x=e.x-e.getBounds().width}else if(e.x>o&&e.x>t.x){e.x=t.x-t.getBounds().width}}}else{e.y-=s.speed*s.direction;t.y-=s.speed*s.direction;if(s.direction*s.speed>0){if(t.y<0&&e.y<t.y){e.y=t.getBounds().height}else if(e.y<0&&t.y<e.y){t.y=e.getBounds().height}}else{if(t.y>u&&t.y>e.y){t.y=e.y-e.getBounds().height}else if(e.y>u&&e.y>t.y){e.y=t.y-t.getBounds().height}}}stage.update()}if(zon)zog("zimbuild.js: Scroller");var s=this;this.speed=zot(n)?1:n;this.direction=zot(r)?1:r;if(!e.getBounds()||!t.getBounds())if(zon){zog("please setBounds() on backing objects");return}var o=e.getStage().canvas.width;var u=e.getStage().canvas.height;if(i){t.x=e.getBounds().width}else{t.y=e.getBounds().height}var a=createjs.Ticker.on("tick",f);createjs.Ticker.setFPS(60);this.dispose=function(){if(zon)zog("bye from Scroller");createjs.Ticker.off("tick",a)}};e.move=function(e,t,n,r,i){function o(){createjs.Ticker.off("tick",s)}createjs.Tween.get(e).to({x:t,y:n},r,createjs.Ease[i]).call(o);var s=createjs.Ticker.on("tick",stage)};e.Damp=function(e,t){if(zon)zog("zimbuild.js: Damp");this.lastValue=zot(e)?0:e;this.damp=zot(t)?.1:t};e.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp};e.Proportion=function(e,t,n,r,i,s){if(zon)zog("zimbuild.js: Proportion");if(zot(n))n=0;if(zot(r))r=1;if(zot(i))i=1;if(zot(s))s=false;var o;var u;var a;o=e;this.convert=function(o){if(isNaN(o)){return}o=Math.max(o,e);o=Math.min(o,t);u=(o-e)/(t-e);if(i>0){a=n+(r-n)*u}else{a=r-(r-n)*u}if(s){a=Math.round(a)}return a}};e.ProportionDamp=function(e,t,n,r,i,s,o){function m(){if(isNaN(a)){return}a=Math.max(a,e);a=Math.min(a,t);f=(a-e)/(t-e);l=r-n;if(s>0){c=n+l*f}else{c=r-l*f}p=c;h=p-d;d+=h*u.damp;if(o){d=Math.round(d)}}if(zon)zog("zimbuild.js: ProportionDamp");if(zot(n))n=0;if(zot(r))r=1;if(zot(i))i=.1;if(zot(s))s=1;if(zot(o))o=false;this.damp=i;var u=this;var a;var f;var l;var c;var h;var p=0;var d=0;a=e;d=n;var v=setInterval(m,20);this.immediate=function(e){this.convert(e);m();d=c;if(o){d=Math.round(d)}};this.convert=function(e){a=e;return d};this.dispose=function(){clearInterval(v)}};return e}(zim||{})