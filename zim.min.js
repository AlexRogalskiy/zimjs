// ZIM js Interactive Media modules by Dan Zen http://danzen.com (c) 2014
// zim.js includes all the basic zim coding modules http://zimjs.com
// free to use - donations welcome of course! http://zimjs.com/donate

function zid(e){return document.getElementById(e)}function zss(e){return document.getElementById(e).style}function zgo(e,t,n){if(zot(t)&&t!=""&&t!="_self"){window.location.href=e}else{if(zot(n)){window.open(e,"_blank")}else{window.open(e,"_blank","modal=yes,alwaysRaised=yes")}}}function zum(e){return Number(e.replace(/[^\d\.\-]/g,""))}function zot(e){if(e===null)return true;return typeof e==="undefined"}function zop(e){if(e.keyCode&&e.keyCode>=32&&e.keyCode<=40)e.preventDefault();if(e.stopImmediatePropagation)e.stopImmediatePropagation();if(window.event)window.event.cancelBubble=true}if(typeof zon==="undefined")zon=false;var zog=console.log.bind(console);if(zon)zog("ZIM WRAP - zog, zid, zss, zgo, zum, zot, zop");var zim=function(e){if(zon)zog("ZIM CODE Module");e.shuffle=function(e){var t=e.length,n,r;if(t==0)return e;while(--t){n=Math.floor(Math.random()*(t+1));r=e[t];e[t]=e[n];e[n]=r}return e};e.rand=function(e,t,n){if(zot(n))n=true;if(zot(t))t=0;if(zot(e))e=0;if(e>t){e++}else if(t>e){t++}var r;if(e==0&&t==0){return Math.random()}else if(t==0){r=Math.random()*e}else{r=Math.min(e,t)+Math.random()*(Math.max(e,t)-Math.min(e,t))}if(n){return Math.floor(r)}else{return r}};e.copy=function(t){if(t==null||typeof t!="object")return;if(t instanceof Array){return t.slice(0)}if(t instanceof Object){copy={};for(var n in t){if(t.hasOwnProperty(n))copy[n]=e.copy(t[n])}return copy}};e.arraysEqual=function(t,n,r){if(zot(t)||zot(n))return false;if(zot(r))r=true;if(t.length!=n.length)return false;for(var i=0;i<t.length;i++){if(t[i]instanceof Array&&n[i]instanceof Array){if(!e.arraysEqual(t[i],n[i],r))return false}else if(r&&t[i]!=n[i]){return false}else if(!r){return e.arraysEqual(t.sort(),n.sort(),true)}}return true};e.decimals=function(e,t){if(zot(e)||e==0)return 0;if(zot(t))t=1;return Math.round(e*Math.pow(10,t))/Math.pow(10,t)};e.Damp=function(e,t){if(zon)zog("zimcode.js: Damp");this.lastValue=zot(e)?0:e;this.damp=zot(t)?.1:t};e.Damp.prototype.convert=function(e){return this.lastValue=this.lastValue+(e-this.lastValue)*this.damp};e.Proportion=function(e,t,n,r,i,s){if(zon)zog("zimcode.js: Proportion");if(zot(n))n=0;if(zot(r))r=1;if(zot(i))i=1;if(zot(s))s=false;var o;var u;var a;o=e;this.convert=function(o){if(isNaN(o)){return}o=Math.max(o,e);o=Math.min(o,t);u=(o-e)/(t-e);if(i>0){a=n+(r-n)*u}else{a=r-(r-n)*u}if(s){a=Math.round(a)}return a}};e.ProportionDamp=function(e,t,n,r,i,s,o){function m(){if(isNaN(a)){return}a=Math.max(a,e);a=Math.min(a,t);f=(a-e)/(t-e);l=r-n;if(s>0){c=n+l*f}else{c=r-l*f}p=c;h=p-d;d+=h*u.damp;if(o){d=Math.round(d)}}if(zon)zog("zimcode.js: ProportionDamp");if(zot(n))n=0;if(zot(r))r=1;if(zot(i))i=.1;if(zot(s))s=1;if(zot(o))o=false;this.damp=i;var u=this;var a;var f;var l;var c;var h;var p=0;var d=0;a=e;d=n;var v=setInterval(m,20);this.immediate=function(e){this.convert(e);m();d=c;if(o){d=Math.round(d)}};this.convert=function(e){a=e;return d};this.dispose=function(){clearInterval(v)}};e.scrollY=function(){var e=0;var t=navigator.appName;var n=navigator.userAgent.indexOf("Safari");if(n!=-1||t=="Safari"){var e=1}if(!e&&document.compatMode=="CSS1Compat"){return document.documentElement.scrollTop}else{return document.body.scrollTop}};e.windowWidth=function(){return isNaN(window.innerWidth)?window.clientWidth:window.innerWidth};e.windowHeight=function(){return isNaN(window.innerHeight)?window.clientHeight:window.innerHeight};e.urlEncode=function(e){var e=(e+"").toString();return encodeURIComponent(e).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A").replace(/%20/g,"+")};e.urlDecode=function(e){return decodeURIComponent((e+"").replace(/\+/g,"%20"))};e.setCookie=function(e,t,n){if(n){var r=new Date;r.setTime(r.getTime()+n*24*60*60*1e3);var i="; expires="+r.toGMTString()}else{var i=""}document.cookie=e+"="+escape(t)+i+"; path=/"};e.getCookie=function(e){var t=document.cookie.split(/;\s*/);var n=new Array;var r;for(i=0;i<t.length;i++){r=t[i].split("=");n[r[0]]=r[1]}return unescape(n[e])};e.deleteCookie=function(t){e.setCookie(t,"",-1)};return e}(zim||{});var zim=function(e){if(zon)zog("ZIM CREATE Module");e.drag=function(e,t,n,r,i,s){function f(){o=0;u=0;a=e.parent.localToGlobal(e.x,e.y);l(e,a.x,a.y)}function l(t,n,r){if(!e.parent)return;var i=t.parent.globalToLocal(n,r);var s=c(i.x-o,i.y-u);t.x=s.x;t.y=s.y;t.getStage().update()}function c(n,r){if(t){var i=e.parent.localToGlobal(n,r);n=Math.max(t.x,Math.min(t.x+t.width,i.x));r=Math.max(t.y,Math.min(t.y+t.height,i.y));i=e.parent.globalToLocal(n,r);n=i.x;r=i.y}return{x:n,y:r}}e.cursor=zot(n)?"pointer":n;if(zot(i))i=false;if(zot(s))s=false;var o;var u;var a;e.zimAdded=e.on("added",f,null,true);if(e.parent){f()}e.zimDown=e.on("mousedown",function(t){var n=i?t.currentTarget:t.target;var a=n.parent.globalToLocal(t.stageX,t.stageY);o=a.x-t.target.x;u=a.y-t.target.y;e.cursor=zot(r)?"move":r;if(!s)t.stopImmediatePropagation()},true);e.zimMove=e.on("pressmove",function(e){var t=i?e.currentTarget:e.target;l(t,e.stageX,e.stageY)},true);e.zimUp=e.on("pressup",function(t){e.cursor=zot(n)?"pointer":n},true)};e.noDrag=function(e){e.cursor="default";e.off("added",e.zimAdded);e.off("mousedown",e.zimDown);e.off("pressmove",e.zimMove);e.off("pressup",e.zimUp)};e.hitTestPoint=function(e,t,n){var r=e.globalToLocal(t,n);return e.hitTest(r.x,r.y)};e.hitTestReg=function(e,t){var n=t.localToLocal(t.regX,t.regY,e);return e.hitTest(n.x,n.y)};e.hitTestRect=function(e,t,n){if(zot(n))n=0;var r=t.getBounds();if(!r){zog("zimcreate.js hitTestRect():\n please setBounds() on param b object");return}var i,s,o;for(var u=0;u<=n;u++){i=r.width*(u+1)/(n+1);s=r.height*(u+1)/(n+1);o=t.localToLocal(r.x+i,r.y,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x+r.width,r.y+s,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x+r.width-i,r.y+r.height,e);if(e.hitTest(o.x,o.y))return true;o=t.localToLocal(r.x,r.y+r.height-s,e);if(e.hitTest(o.x,o.y))return true}};e.hitTestCircle=function(e,t,n){if(zot(n))n=8;var r=t.getBounds();if(!r){zog("zimcreate.js hitTestCircle():\n please setBounds() on param b object");return}var i=r.x+r.width/2;var s=r.y+r.height/2;var o=(r.width+r.height)/2/2;var u,a,f,l;for(var c=0;c<n;c++){u=c/n*2*Math.PI;a=i+o*Math.cos(u);f=s+o*Math.sin(u);l=t.localToLocal(a,f,e);if(e.hitTest(l.x,l.y))return true}};e.hitTestBounds=function(t,n,r){function l(e,t){if(e.x>=t.x+t.width||e.x+e.width<=t.x||e.y>=t.y+t.height||e.y+e.height<=t.y){return false}else{return true}}var i=false;if(r&&r.graphics)i=true;var s=t.getBounds();var o=n.getBounds();if(!s||!o){zog("zimcreate.js hitTestBounds():\n please setBounds() on both objects");return}var u=e.boundsToGlobal(t);var a=e.boundsToGlobal(n);if(i){var f=r.graphics;f.clear();f.setStrokeStyle(1).beginStroke("blue");f.drawRect(u.x,u.y,u.width,u.height);f.beginStroke("green");f.drawRect(a.x,a.y,a.width,a.height);r.getStage().update()}return l(u,a)};e.boundsToGlobal=function(e){var t=e.getBounds();if(!t){zog("zimcreate.js boundsToGlobal():\n please setBounds() on both objects");return}var n=e.localToGlobal(t.x,t.y);var r=e.localToGlobal(t.x+t.width,t.y);var i=e.localToGlobal(t.x+t.width,t.y+t.height);var s=e.localToGlobal(t.x,t.y+t.height);var o=Math.min(n.x,r.x,i.x,s.x);var u=Math.min(n.y,r.y,i.y,s.y);var a=Math.max(n.x,r.x,i.x,s.x);var f=Math.max(n.y,r.y,i.y,s.y);return new createjs.Rectangle(o,u,a-o,f-u)};e.scale=function(e,t){if(zot(e))return;if(zot(t))t=1;e.scaleX=e.scaleY=t};e.move=function(e,t,n,r,i){function o(){createjs.Ticker.off("tick",s)}if(zot(i))i="quadInOut";createjs.Tween.get(e,{override:true}).to({x:t,y:n},r,createjs.Ease[i]).call(o);var s=createjs.Ticker.on("tick",stage)};e.animate=function(e,t,n,r,i,s,o){function a(){if(i){i(s)}createjs.Ticker.off("tick",u)}if(zot(r))r="quadInOut";if(zot(o))o=0;createjs.Tween.get(e).wait(o).to(t,n,createjs.Ease[r]).call(a);var u=createjs.Ticker.on("tick",stage)};e.fit=function(e,t,n,r,i,s){if(zot(e))return;if(!e.getBounds()){zog("zimcreate.js fit(): please setBounds() on object");return}if(zot(t)){if(!e.getStage()){zog("zimcreate.js fit(): please add boundary dimensions or add obj to stage first");return}if(!e.getStage().getBounds()){zog("zimcreate.js fit(): please add boundary dimensions or add obj with bounds to stage first");return}var o=e.getStage().getBounds().width;var u=e.getStage().getBounds().height;t=0;n=0;r=o;i=u}if(zot(s))s=true;e.scaleX=e.scaleY=1;var a=r;var f=i;var l=e.getBounds().width;var c=e.getBounds().height;var h;if(s){if(a/f>=l/c){h=f/c}else{h=a/l}}else{if(a/f>=l/c){h=a/l}else{h=f/c}}e.scaleX=e.scaleY=h;var p=l*h;var d=c*h;e.x=t+(a-p)/2;e.y=n+(f-d)/2;return{x:e.x,y:e.y,width:p,height:d,scale:h}};e.outline=function(e,t,n){if(zot(e)){zog("zimcreate.js outline(): please provide object and shape");return}if(!e.getBounds()){zog("zimcreate.js outline(): please setBounds() on object");return}if(!e.parent){zog("zimcreate.js outline(): object should be on stage first");return}if(zot(t))t="brown";if(zot(n))n=2;var r=e.getBounds();var i=new createjs.Shape;var s=e.parent;var o=e.localToLocal(r.x,r.y,s);var u=e.localToLocal(r.x+r.width,r.y,s);var a=e.localToLocal(r.x+r.width,r.y+r.height,s);var f=e.localToLocal(r.x,r.y+r.height,s);var l=i.graphics;l.s(t).ss(n).r(o.x,o.y,u.x-o.x,a.y-u.y);zero={x:o.x-r.x*e.scaleX,y:o.y-r.y*e.scaleY};var c=10;var h=c+1;l.s("white").ss(n+2);l.mt(zero.x-h,zero.y+0).lt(zero.x+h,zero.y+0);l.mt(zero.x+0,zero.y-h).lt(zero.x+0,zero.y+h);l.s(t).ss(n);l.mt(zero.x-c,zero.y+0).lt(zero.x+c,zero.y+0);l.mt(zero.x+0,zero.y-c).lt(zero.x+0,zero.y+c);l.s("white").ss(n+2).dc(e.x,e.y,c+6);l.s(t).ss(n).dc(e.x,e.y,c+6);e.parent.addChild(i);if(e.getStage())e.getStage().update()};return e}(zim||{});var zim=function(e){if(zon)zog("ZIM BUILD Module");e.Triangle=function(t,n,r,i,s,o,u,a){function f(){if(zot(t))t=100;if(zot(n))n=t;if(zot(r))r=t;if(zot(i))i="black";if(zot(u))u=true;if(zot(a))a=0;var e=[t,n,r];e.sort(function(e,t){return t-e});aa=e[0];bb=e[1];cc=e[2];if(aa>bb+cc){zog("zimbuild.js Triangle(): invalid triangle lengths");return}var f=new createjs.Shape;var l=f.graphics;l.f(i);if(!zot(s)){l.s(s);if(zot(o))o=1;l.ss(o)}l.mt(0,0);l.lt(t,0);var h=Math.acos((Math.pow(bb,2)+Math.pow(cc,2)-Math.pow(aa,2))/(2*bb*cc))*180/Math.PI;var p=Math.asin(bb*Math.sin(h*Math.PI/180)/aa)*180/Math.PI;var d=180-h-p;var v;if(r==aa){v=h}else if(r==bb){v=p}else{v=d}var m=Math.cos(v*Math.PI/180)*n;var g=Math.sin(v*Math.PI/180)*n;f.width=Math.max(t,t-m);f.height=g;f.setBounds(0,0,f.width,-f.height);l.lt(t-m,0-g);l.lt(0,0);if(u){f.regX=f.width/2;f.regY=-f.height/2+a}return f}f.prototype=new createjs.Shape;f.constructor=e.Triangle;return new f};e.Label=function(t,n,r,i,s,o,u){function a(){if(zot(t))t="LABEL";if(t=="")t=" ";if(zot(n))n=36;if(zot(r))r="arial";if(zot(i))i="black";if(zot(s))s=i;if(zot(o))o=null;if(zot(u))u=16;var a=this;this.mouseChildren=false;var f=this.label=new createjs.Text(String(t),n+"px "+r,i);f.textBaseline="alphabetic";f.textAlign="left";if(o&&u>0)f.shadow=new createjs.Shadow(o,3,3,u);this.addChild(f);var l=new createjs.Shape;l.graphics.f("rgba(0,255,255,.01)").r(0,0,this.getBounds().width,this.getBounds().height);this.addChildAt(l,0);this.setBounds(0,0,this.getBounds().width,this.getBounds().height);f.y=n-n/6;Object.defineProperty(a,"text",{get:function(){var e=f.text==" "?"":f.text;return e},set:function(e){f.text=e}});this.showRollColor=function(e){if(zot(e))e=true;if(e){f.color=s}else{f.color=i}if(a.getStage())a.getStage().update()};this.on("mouseover",function(e){a.showRollColor()});this.on("mouseout",function(e){a.showRollColor(false)});this.clone=function(){return new e.Label(a.text,n,r,i,s,o,u)};this.dispose=function(){a.removeAllEventListeners()}}a.prototype=new createjs.Container;a.constructor=e.Label;return new a};e.Button=function(t,n,r,i,s,o,u,a,f,l){function c(){function d(e){p.on("mouseout",v);var r=c.graphics;r.clear();r.f(s);if(o)r.s(o).ss(u);r.rr(0,0,t,n,a);p.label.showRollColor();if(p.getStage())p.getStage().update()}function v(e){p.off("mouseout",v);var r=c.graphics;r.clear();r.f(i);if(o)r.s(o).ss(u);r.rr(0,0,t,n,a);p.label.showRollColor(false);if(p.getStage())p.getStage().update()}if(zot(t))t=200;if(zot(n))n=60;if(zot(i))i="#C60";if(zot(s))s="#F93";if(zot(o))o=null;if(zot(u))u=1;if(zot(a))a=20;if(zot(f))f="#666";if(zot(l))l=16;if(zot(r))r="PRESS";if(typeof r==="string"||typeof r==="number")r=new e.Label(r,36,"arial","white");this.mouseChildren=false;this.cursor="pointer";var c=new createjs.Shape;var h=c.graphics;h.f(i);if(o)h.s(o).ss(u);h.rr(0,0,t,n,a);this.addChild(c);this.backing=c;if(l>0)c.shadow=new createjs.Shadow(f,3,3,l);this.setBounds(0,0,t,n);this.width=t;this.height=n;r.x=(t-r.getBounds().width)/2+1;r.y=(n-r.getBounds().height)/2+2;this.addChild(r);this.label=r;this.on("mouseover",d);var p=this;this.dispose=function(){p.removeAllEventListeners();p.removeChild(c);p.removeChild(buttonLabel);c=null;buttonLabel=null}}c.prototype=new createjs.Container;c.constructor=e.Button;return new c};e.CheckBox=function(t,n,r,i,s){function o(){function d(e){o=!o;u.setChecked(o);u.dispatchEvent("change")}if(zot(t))t=60;if(zot(n))n=null;if(typeof n==="string"||typeof n==="number")n=new e.Label(n,t*5/6,"arial",i);var o=zot(r)?false:r;if(zot(i))i="black";if(zot(s))s=10;this.setBounds(-s,-s,t+s*2,t+s*2);var u=this;this.cursor="pointer";var a=new createjs.Shape;var f=a.graphics;f.f("rgba(0,0,0,.01)").r(this.getBounds().x,this.getBounds().y,this.getBounds().width,this.getBounds().height);f.f("rgba(255,255,255,.5)").r(0,0,t,t);f.s(i).ss(t/10).r(t/7,t/7,t-t/7*2,t-t/7*2);this.addChild(a);if(n){this.addChild(n);n.x=this.getBounds().width;n.y=t/8;this.label=n}var l=new createjs.Shape;var c=l.graphics;c.f(i).p("AnQAdICBiaIEEDZIF8nfICfB4In/KPg");var h=95;l.setBounds(-h/2,-h/2,h,h);var p=t/(h+66);l.scaleX=l.scaleY=p;l.x=t/2;l.y=t/2;if(o)this.addChild(l);this.on("click",d);Object.defineProperty(u,"checked",{get:function(){return o},set:function(e){u.setChecked(e)}});this.setChecked=function(e){if(zot(e))e=true;o=e;if(o){u.addChild(l)}else{u.removeChild(l)}if(u.getStage())u.getStage().update()};this.dispose=function(){u.removeAllEventListeners()}}o.prototype=new createjs.Container;o.constructor=e.CheckBox;return new o};e.RadioButtons=function(t,n,r,i,s,o){function u(){function l(e){u.setSelected(f.getChildIndex(e.target));u.dispatchEvent("change")}function h(){var o;var l=false;for(var c=n.length-1;c>=0;c--){o=n[c];if(o.selected&&o.selected===true){if(!l){l=true}else{o.selected="false"}}}f.removeAllChildren();var h;var d=0;for(var c=0;c<n.length;c++){o=n[c];if(typeof o==="string"||typeof o==="number"){var v={selected:false,label:new e.Label(o,t*5/6,"arial",i)};o=v}if(o.label&&typeof o.label==="string"||typeof o.label==="number"){o.label=new e.Label(o.label,t*5/6,"arial",i)}u.labels.push(o.label);o.index=c;h=p(o.selected,o.label);h.obj=o;if(o.selected)a=h.obj;f.addChild(h);if(r){h.y=d;d+=h.getBounds().height+s}else{h.x=d;d+=h.getBounds().width+s}}}function p(e,n){var r=new createjs.Container;r.mouseChildren=false;r.setBounds(-o,-o,t+o*2,t+o*2);var s=new createjs.Shape;var a=s.graphics;a.f("rgba(0,0,0,.01)").r(r.getBounds().x,r.getBounds().y,r.getBounds().width,r.getBounds().height);a.f("rgba(255,255,255,.5)").dc(t/2,t/2,t/1.85);a.s(i).ss(t/9).dc(t/2,t/2,t/2-t/2/5);r.addChild(s);var f=r.check=new createjs.Shape;f.mouseEnabled=false;f.alpha=.95;var l=f.graphics;l.f(i).dc(t/2,t/2,t/5.2);if(n){r.addChild(n);n.x=r.getBounds().width;n.y=t/8;u.label=n;r.setBounds(-o,-o,t+o*2+n.getBounds().width,Math.max(t+o*2,n.getBounds().height))}if(e)r.addChild(f);return r}if(zot(t))t=60;if(zot(n))return;if(zot(r))r=true;if(zot(i))i="black";if(zot(s))s=r?t*.2:t;if(zot(o))o=t/5;var u=this;this.cursor="pointer";this.labels=[];var a;var f=this.buttons=new createjs.Container;this.addChild(f);f.on("click",l);h();var c;this.setBounds(0,0,this.getBounds().width+o,this.getBounds().height+o);this.setSelected=function(e){function i(){}if(zot(e))e=-1;if(e!=-1&&!f.getChildAt(e))return;var t;for(var n=0;n<f.getNumChildren();n++){t=f.getChildAt(n);t.removeChild(t.check)}if(e>=0){t=f.getChildAt(e);var r=-2;if(a)r=a.index;a=t.obj}if(e==-1||r==a.index){a=null;u.id=null;u.label=null;u.text=""}else{t.addChild(t.check);u.id=a.id;u.label=a.label;if(u.label)u.text=u.label.text}if(u.getStage())u.getStage().update()};Object.defineProperty(u,"selected",{get:function(){return a},set:function(e){selectedIndex=e}});Object.defineProperty(u,"selectedIndex",{get:function(){return a?a.index:-1},set:function(e){this.setSelected(e)}});this.dispose=function(){u.removeAllEventListeners()}}u.prototype=new createjs.Container;u.constructor=e.RadioButtons;return new u};e.Pane=function(t,n,r,i,s,o,u,a,f,l,c,h){function p(){function b(e,i){e=Math.max(n/2,Math.min(t.getBounds().width-n/2,e));i=Math.max(r/2,Math.min(t.getBounds().height-r/2,i));return{x:e,y:i}}if(zot(t)){zog("zimbuild.js Pane(): Please pass in a reference to the stage with bounds set as first parameter");return}if(!t.getBounds()){zog("zimbuild.js Pane(): Please give the stage bounds using setBounds()");return}if(zot(n))n=200;if(zot(r))r=200;if(zot(i))i=null;if(typeof i==="string"||typeof i==="number")i=new e.Label(i,40,"arial","black");if(zot(s))s="white";if(zot(o))o=false;if(zot(u))u=false;if(zot(a))a=true;if(zot(f))f=20;if(zot(l))l=.14;if(zot(c))c="#333";if(zot(h))h=20;var p=this.backing=new createjs.Shape;var d=p.graphics;d.beginFill("black");d.drawRect(-5e3,-5e3,1e4,1e4);this.setBounds(-n/2,-r/2,n,r);p.alpha=l;var v=this;p.on("click",function(e){v.hide();v.dispatchEvent("close");e.stopImmediatePropagation()});p.on("mousedown",function(e){e.stopImmediatePropagation()});if(a)this.addChild(p);var m=this.display=new createjs.Shape;m.setBounds(0,0,n,r);m.regX=n/2;m.regY=r/2;d=m.graphics;d.beginFill(s);d.drawRoundRect(0,0,n,r,f);if(h>0)m.shadow=new createjs.Shadow(c,8,8,h);m.on("click",function(e){e.stopImmediatePropagation()});this.resetX;this.resetY;if(o){m.cursor="pointer";var g,y;m.on("mousedown",function(e){if(isNaN(v.resetX))v.resetX=v.x;if(isNaN(v.resetY))v.resetY=v.y;g=e.stageX-v.x;y=e.stageY-v.y;m.cursor="move"});m.on("pressmove",function(e){var n=b(e.stageX-g,e.stageY-y);v.x=n.x;v.y=n.y;t.update()});this.on("pressup",function(e){m.cursor="pointer"})}this.addChild(m);if(i){i.x=-i.getBounds().width/2;i.y=-i.getBounds().height/2;this.addChild(i);this.label=i;this.text=i.text}t.update();this.hide=function(){t.removeChild(v);t.update();if(u){if(!isNaN(v.resetX))v.x=v.resetX;if(!isNaN(v.resetY))v.y=v.resetY}};this.show=function(){v.x=t.getBounds().width/2;v.y=t.getBounds().height/2;t.addChild(v);t.update()};this.dispose=function(){m.removeAllEventListeners();v.removeChild(m);m=null}}p.prototype=new createjs.Container;p.constructor=e.Pane;return new p};e.Parallax=function(t,n,r){function l(e){var n;var r;var i;var s;for(var o=0;o<u.length;o++){n=u[o];s=n.parent.localToGlobal(n.zimsX,n.zimsY);r=s.x;i=s.y;if(n.zimX!=0){r=r-n.zimX/2+n.zimpX.convert(t.mouseX)}if(n.zimY!=0){i=i-n.zimY/2+n.zimpY.convert(t.mouseY)}s=n.parent.globalToLocal(r,i);n.x=s.x;n.y=s.y}t.update()}if(zon)zog("zimbuild.js: Parallax");if(zot(t)){zog("zimbuild.js: Parallax(): please pass in the stage with bounds as first parameter");return}if(!t.getBounds()){zog("zimbuild.js Pane(): Please give the stage bounds using setBounds()");return}var i=t.getBounds().width;var s=t.getBounds().height;var o=this;this.damp=zot(n)?.1:n;this.addLayer=function(t,n,r){if(zot(t))return;t.zimX=zot(n)?0:n;t.zimY=zot(r)?0:r;if(t.zimX!=0){t.zimpX=new e.ProportionDamp(0,i,0,t.zimX,o.damp)}if(t.zimY!=0){t.zimpY=new e.ProportionDamp(0,s,0,t.zimY,o.damp)}t.zimsX=t.x;t.zimsY=t.y;u.push(t)};this.dispose=function(){u=null;createjs.Ticker.off("tick",f)};r=zot(r)?[]:r;var u=[];for(var a=0;a<r.length;a++){this.addLayer(r[a][0],r[a][1],r[a][2])}var f=createjs.Ticker.on("tick",l);createjs.Ticker.setFPS(60)};e.Scroller=function(e,t,n,r,i,s){function l(n){if(!e.getStage())return;if(!e.getStage().getBounds()){zog("zimbuild.js: Scroller(): please setBounds() on stage");return}if(!u){u=e.getStage().getBounds().width;a=e.getStage().getBounds().height}if(o.speed==0||o.direction==0){return}if(i){e.x-=o.speed*o.direction;t.x-=o.speed*o.direction;if(o.direction*o.speed>0){if(t.x<0&&e.x<t.x){e.x=t.getBounds().width-o.gapFix}else if(e.x<0&&t.x<e.x){t.x=e.getBounds().width-o.gapFix}}else{if(t.x>u&&t.x>e.x){t.x=e.x-e.getBounds().width+o.gapFix}else if(e.x>u&&e.x>t.x){e.x=t.x-t.getBounds().width+o.gapFix}}}else{e.y-=o.speed*o.direction;t.y-=o.speed*o.direction;if(o.direction*o.speed>0){if(t.y<0&&e.y<t.y){e.y=t.getBounds().height-o.gapFix}else if(e.y<0&&t.y<e.y){t.y=e.getBounds().height-o.gapFix}}else{if(t.y>a&&t.y>e.y){t.y=e.y-e.getBounds().height+o.gapFix}else if(e.y>a&&e.y>t.y){e.y=t.y-t.getBounds().height+o.gapFix}}}e.getStage().update()}if(zon)zog("zimbuild.js: Scroller");var o=this;this.speed=zot(n)?1:n;this.direction=zot(r)?1:r;this.gapFix=zot(s)?0:s;if(!e.getBounds()||!t.getBounds()){zog("zimbuild.js: Scroller(): please setBounds() on backing objects");return}if(!e.getStage()){zog("zimbuild.js: Scroller(): please add backing objects to stage to start");return}var u;var a;if(i){t.x=e.getBounds().width}else{t.y=e.getBounds().height}var f=createjs.Ticker.on("tick",l);createjs.Ticker.setFPS(60);this.dispose=function(){if(zon)zog("bye from Scroller");createjs.Ticker.off("tick",f)}};return e}(zim||{});var zim=function(zim){if(zon)zog("ZIM PAGES Module");zim.Swipe=function(e,t,n){function r(){if(zot(e)){zog("zimcreate.js Swipe():\nPlease pass in object");return}if(zot(t))t=100;if(zot(n))n=200;var r;var i;var s;var o;var u;var a;var f=this;e.on("mousedown",function(l){f.obj=l.target;r=l.stageX;i=l.stageY;u=true;clearTimeout(a);a=setTimeout(function(){if(u){if(Math.abs(s-r)>Math.abs(o-i)){if(s-r>t){f.direction="right";f.dispatchEvent("swipe");u=false}if(r-s>t){f.direction="left";f.dispatchEvent("swipe");u=false}}else{if(o-i>t){f.direction="down";f.dispatchEvent("swipe");u=false}if(i-o>t){f.direction="up";f.dispatchEvent("swipe");u=false}}}},n);e.on("pressmove",function(e){s=e.stageX;o=e.stageY});e.on("pressup",function(e){if(u){f.direction="none";f.dispatchEvent("swipe")}u=false;clearTimeout(a)})})}r.prototype=new createjs.EventDispatcher;r.prototype.constructor=zim.Swipe;return new r};zim.Pages=function(e,t,n,r,i){function s(){function c(){f=new createjs.Shape;f.graphics.f("black").r(0,0,o,u+1);l=new createjs.Shape;l.graphics.f("white").r(0,0,o,u+1)}if(!e.getBounds()){zog("zimbuild.js Pages():\nobject must have bounds set");return}if(zot(t))t=[];if(zot(n))n="none";if(zot(r))r=200;if(zot(i))i=[];this.transitionTable=i;this.speed=r;this.active=true;var s=this;var o=e.getBounds().width;var u=e.getBounds().height;var a=this.page=t[0]?t[0].page:null;var f;var l;if(n!="none"||i!=[])c();var h=["left","right","up","down"];var p;var d;for(var v=0;v<t.length;v++){p=t[v];p.page.zimSwipeArray=p.swipe?p.swipe:[]}this.addChild(a);var m=new zim.Swipe(e);var g;var y=false;var b=m.on("swipe",function(e){if(!s.active)return;var t=e.currentTarget.direction;if(t=="none")return;var n="";if(t=="left")n="right";else if(t=="right")n="left";else if(t=="up")n="down";else if(t=="down")n="up";t=n;var r=h.indexOf(t);d=a.zimSwipeArray[r];g=[d,t,null,null,true];s.page=a;s.nextPage=d;s.direction=t;s.dispatchEvent("swipe");setTimeout(function(){if(!y){s.go(d,t,null,null,true)}},100)});this.addPage=function(e,t){if(zot(t))t=[];var n={page:e,swipe:t};n.page.zimSwipeArray=n.swipe?n.swipe:[];if(!a){a=s.page=n.page;s.addChild(a)}};this.removePage=function(t){if(s.currentPage==t){s.removeChild(t);if(e.getStage())e.getStage().update()}t.zimSwipeArray=null};this.setSwipe=function(e,t){if(zot(t))t=[];var n={page:e,swipe:t};n.page.zimSwipeArray=n.swipe?n.swipe:[]};this.pause=function(){y=true};this.unpause=function(){if(y)s.go(g[0],g[1],g[2],g[3],g[4])};this.go=function(t,i,c,p,d){setTimeout(function(){y=false},200);var v=[{x:o},{x:-o},{y:u},{y:-u}];var m=[{x:0},{x:0},{y:0},{y:0}];var g=[{x:o/2,alpha:0},{x:-o/2,alpha:0},{y:u/2,alpha:0},{y:-u/2,alpha:0}];var b=n;var w=r;for(var E=0;E<s.transitionTable.length;E++){if(s.transitionTable[E][0]==a&&s.transitionTable[E][1]==t){b=s.transitionTable[E][2];w=s.transitionTable[E][3];break}}if(zot(c))c=b;if(zot(p))p=w;s.speed=p;s.direction=i;if(t==""||t==null){s.page=a;s.dispatchEvent("nothing")}else if(typeof t==="string"){s.page=a;s.dispatchEvent(t)}else{if(t==a)return;if(zot(i))i="right";var S=h.indexOf(i);function x(e){e[0].uncache();e[1].uncache();s.dispatchEvent("pageTransitioned");s.removeChild(s.lastPage);s.removeChild(f);s.removeChild(l)}function T(e){s.removeChild(s.lastPage);zim.animate(e.unshift(),{alpha:0},s.speed/2,null,x,e)}t.x=0;t.y=0;t.alpha=1;if(c=="slide"){t.x=-(v[S].x|0);t.y=-(v[S].y|0);t.cache(0,0,o+1,u+1);a.cache(0,0,o+1,u+1);s.addChild(t);s.addChild(a);zim.animate(a,v[S],s.speed,null,x,[a,t]);zim.animate(t,m[S],s.speed)}else if(c=="reveal"){t.cache(0,0,o+1,u+1);a.cache(0,0,o+1,u+1);s.addChild(t);s.addChild(a);zim.animate(a,g[S],s.speed,null,x,[a,t])}else if(c=="fade"){t.cache(0,0,o+1,u+1);a.cache(0,0,o+1,u+1);t.alpha=1;s.addChild(t);s.addChild(a);zim.animate(a,{alpha:0},s.speed,null,x,[a,t])}else if(c=="black"){t.cache(0,0,o+1,u+1);a.cache(0,0,o+1,u+1);t.alpha=1;s.addChild(t);s.addChild(a);f.alpha=0;s.addChild(f);zim.animate(f,{alpha:1},s.speed/2,null,T,[f,a,t])}else if(c=="white"){t.cache(0,0,o+1,u+1);a.cache(0,0,o+1,u+1);t.alpha=1;s.addChild(t);s.addChild(a);l.alpha=0;s.addChild(l);zim.animate(l,{alpha:1},s.speed/2,null,T,[l,a,t])}else{s.addChild(t);s.removeChild(a)}s.lastPage=a;s.page=t;if(zot(d))d=false;s.fromSwipe=d;s.dispatchEvent("page");a=t;if(e.getStage())e.getStage().update()}};this.resize=function(){o=e.getBounds().width;u=e.getBounds().height;if(n!="none"||i!=[])c()};this.puff=function(e){for(var n=0;n<t.length;n++){s.addChild(t[n].page)}s.addChild(a);if(e>0){setTimeout(function(){s.settle()},e)}};this.settle=function(){s.removeAllChildren();s.addChild(a);s.dispatchEvent("puffed")};this.disable=function(){s.active=false};this.enable=function(){s.active=true};this.dispose=function(){m.off("swipe",b);s.removeAllChildren();t=null}}s.prototype=new createjs.Container;s.prototype.constructor=zim.Pages;return new s};zim.HotSpots=function(e,t,n){function r(){function a(e){var r=null;if(!Array.isArray(e.rect)){r=e.rect;if(!r){zog("ZIM Build() :: HotSpot "+e.page+" "+e.rect+" button does not exist");return}if(!r.getBounds()){zog("ZIM Build() :: HotSpots button needs bounds");return}e.rect=[r.x,r.y,r.getBounds().width,r.getBounds().height]}s=new zim.HotSpot(e.page,e.rect[0],e.rect[1],e.rect[2],e.rect[3],e.call,t);s.zimHSpage=e.page;s.button=r;o.push(s);s.on("click",f);if(r){s.spot.mouseEnabled=false;s.spot.mouseChildren=false;r.zimHScall=e.call;r.zimHSEvent=r.on("click",f);if(!n){r.zimHSMDEvent=r.on("mousedown",function(e){e.stopImmediatePropagation()})}r.cursor="pointer"}}function f(e){if(typeof e.currentTarget.zimHScall=="function"){e.currentTarget.zimHScall()}}if(zot(t))t=true;if(zot(n))n=false;var r=this;var i;var s;var o=[];for(var u=0;u<e.length;u++){a(e[u])}this.addHotSpot=function(t,n,r){i={page:t,rect:n,call:r};e.push(i);a(i)};this.show=function(){for(var e=0;e<o.length;e++){s=o[e];if(!s.button)s.show()}};this.hide=function(){for(var e=0;e<o.length;e++){s=o[e];s.hide()}};this.removeHotSpots=function(t,n){for(var r=e.length-1;r>=0;r--){i=e[r];s=o[r];if(n&&!Array.isArray(n)){n=[n.x,n.y,n.getBounds().width,n.getBounds().height]}if(zot(t)&&zot(n)||zot(n)&&t==i.page||zot(t)&&zim.arraysEqual(n,i.rect)||t==i.page&&zim.arraysEqual(n,i.rect)){e.splice(r,1);if(s.button){s.button.off("click",s.button.zimHSEvent);s.button.zimHSEvent=null}s.off("click",f);s.dispose();o.splice(r,1)}}};this.dispose=function(){for(var e=0;e<o.length;e++){s=o[e];if(s.button){s.button.off("click",s.button.zimHSEvent);s.button.zimHSCall=null;s.button.zimHSEvent=null}s.off("click",f);s.dispose()}}}r.prototype=new createjs.Container;r.prototype.constructor=zim.HotSpots;return new r};zim.HotSpot=function(e,t,n,r,i,s,o){function u(){if(zot(e)){zog("zimbuild.js HotSpot():\nPlease pass in object");return}if(e instanceof createjs.Container==false)zog("zimbuild.js HotSpot():\nObjects passed in should be Containers");if(zot(o))o=true;var u=this;var a=new createjs.Shape;this.spot=a;if(!o){var f=e.globalToLocal(t,n);var l=e.globalToLocal(t+r,n+i);var c=l.x-f.x;var p=l.y-f.y;a.graphics.f("#999999").dr(f.x,f.y,c,p)}else{a.graphics.f("#999999").dr(t,n,r,i)}a.alpha=.01;a.cursor="pointer";var d=a.on("click",function(){if(typeof s=="function"){s()}});e.addChild(a);this.show=function(){a.alpha=.5};this.hide=function(){a.alpha=.01};this.dispose=function(){a.off("click",d);e.removeChild(a);delete a}}u.prototype=new createjs.Container;u.prototype.constructor=zim.HotSpot;return new u};zim.Grid=function(e,t,n){function r(){function E(){clearInterval(b);if(e=="stage"){i=r.getStage();e=i}else{i=e.getStage()}if(!w){k();e.addChild(r)}i.off("stagemousemove",o);o=i.on("stagemousemove",x);i.update()}function x(t){var r;if(t){r=e.globalToLocal(t.rawX,t.rawY);S=r}else{r={x:S.x,y:S.y}}if(!n){c.text="x:"+Math.max(0,Math.min(Math.round(r.x),Math.round(T)));f.x=Math.max(v,Math.min(r.x,g));d.text="y:"+Math.max(0,Math.min(Math.round(r.y),Math.round(N)));h.y=Math.max(m,Math.min(r.y,y))}else{c.text="x:"+Math.max(0,Math.min(Math.round(r.x/T*100),100))+"%";f.x=Math.max(v,Math.min(r.x,g));d.text="y:"+Math.max(0,Math.min(Math.round(r.y/N*100),100))+"%";h.y=Math.max(m,Math.min(r.y,y))}if(i)i.update()}function k(){w=true;T=e.getBounds().width;N=e.getBounds().height;i.mouseMoveOutside=true;i.enableMouseOver(10);g=T-u*2/3;y=N-a;C=new createjs.Container;r.addChild(C);var o=new createjs.Shape;C.addChild(o);var l=o.graphics;l.s(t).ss(1);var c=new createjs.Shape;C.addChild(c);if(!n){for(var p=0;p<T/s;p++){l.mt(p*s,0).lt(p*s,N)}for(var p=0;p<N/s;p++){l.mt(0,p*s).lt(T,p*s)}o.alpha=.3;l=c.graphics;l.s(t).ss(1);for(var p=0;p<T/(s*10);p++){l.mt(p*s*10,0).lt(p*s*10,N)}for(var p=0;p<N/(s*10);p++){l.mt(0,p*s*10).lt(T,p*s*10)}}else{for(var p=1;p<20+2;p++){l.mt(p*T/20,0).lt(p*T/20,N)}for(var p=1;p<20;p++){l.mt(0,p*N/20).lt(T,p*N/20)}o.alpha=.3;l=c.graphics;l.s(t).ss(1);for(var p=1;p<10;p++){l.mt(p*T/10,0).lt(p*T/10,N)}for(var p=1;p<10;p++){l.mt(0,p*N/10).lt(T,p*N/10)}}var d=80;l.s("#FFFFFF").ss(8);l.mt(T/2,N/2-d/2).lt(T/2,N/2+d/2);l.mt(T/2-d/2,N/2).lt(T/2+d/2,N/2);l.s("#000000").ss(4);l.mt(T/2,N/2-d/2).lt(T/2,N/2+d/2);l.mt(T/2-d/2,N/2).lt(T/2+d/2,N/2);l.s(t).ss(3);l.dr(0,0,T,N);c.alpha=.5;C.cache(0,0,T,N);r.addChild(f);r.addChild(h);i.update()}function L(e){if(!e)e=event;if(!i)return;if(e.keyCode==71){r.visible=!r.visible;i.off("stagemousemove",o);if(r.visible){o=i.on("stagemousemove",x,r)}i.update()}if(e.keyCode==80){r.removeChild(C);C=null;r.pixels=!r.pixels}}if(zot(e))e="stage";if(zot(t))t="black";if(e!="stage"&&!e.getBounds()){zog("zimbuild.js Grid(): Please provide bounds for the object (setBounds())");return}if(zot(n))n=true;var r=this;var i;var s=10;var o;this.mouseChildren=false;this.mouseEnabled=false;var u=80;var a=26;var f=new createjs.Container;var l=new createjs.Shape;l.graphics.s(t).ss(1).f("#dddddd").r(0,0,u,a);l.regX=u/2;l.regY=-a/4;l.alpha=.9;f.addChild(l);var c=new createjs.Text("10","16px verdana","#333333");c.textAlign="center";c.textBaseline="middle";c.y=a*3/4;f.addChild(c);var h=new createjs.Container;var p=new createjs.Shape;p.graphics.s(t).ss(1).f("#dddddd").r(0,0,u,a);p.regX=-u/6;p.regY=a/2;p.alpha=.9;h.addChild(p);var d=new createjs.Text("10","16px verdana","#333333");d.textAlign="center";d.textBaseline="middle";d.x=u/2+u/6;h.addChild(d);var v=u/6+u/2;var m=a*2;var g;var y;f.x=v;h.y=m;c.text="x:0";d.text="y:0";var b=setInterval(function(){if(e=="stage"){if(r&&r.getStage()){E()}}else{if(e&&e.getStage()){E()}}},100);var w=false;var S={x:0,y:0};var T;var N;var C;Object.defineProperty(this,"pixels",{get:function(){return!n},set:function(e){n=!e;r.resize()}});window.addEventListener("keydown",L);this.resize=function(){r.removeChild(C);C=null;if(i){k();x();setTimeout(function(){r.removeChild(C);C=null;k()},200)}};this.dispose=function(){clearInterval(b);r.removeAllChildren();if(r.parent)r.parent.removeChild(r);r=null;window.removeEventListener("keydown",L)}}r.prototype=new createjs.Container;r.prototype.constructor=zim.Grid;return new r};zim.GridManager=function(){if(zon)zog("zimbuild.js: GridManager");var e=this;this.grids=[];this.add=function(t){e.grids.push(t)};this.resize=function(){if(!e)return;for(var t=0;t<e.grids.length;t++){e.grids[t].resize()}};this.dispose=function(){for(var t=0;t<e.grids.length;t++){e.grids[t].dispose()}if(zon)zog("zimbuild.js: GridManager - grids disposed");e=null}};zim.Layout=function(holder,region1,region2,region3,lastMargin,backgroundColor,vertical,regionShape,scalingObject){function makeLayout(){function calculate(){function state1(){if(logStates){state=1;if(state!=lastState){zog("Flexive State "+state);lastState=state}}if(obj1)setFitPrimary(1,margin1*primary/100,min1*primary/100);if(obj3)setFitPrimary(3,primary-min3*primary/100-margin4*primary/100,min3*primary/100)}function state2(){if(logStates){state=2;if(state!=lastState){zog("Flexive State "+state);lastState=state}}if(regionShape)regionShape.graphics.clear();backing.graphics.clear();if(backgroundColor!=-1)backing.graphics.f(backgroundColor).r(0,0,bounds.width,bounds.height);primaryPos=0;secondaryPos=0;secondaryLen=1e4;if(scale1>=scale3){if(obj3){var e=leftover-primaryFit3;if(e>=p1*scale3){if(obj2)setFit(1,primaryPos,secondaryPos,e,secondaryLen)}else{newScale=leftover/(p1+p3)}}else{if(obj2)setFit(1,primaryPos,secondaryPos,leftover,secondaryLen)}}else{if(obj1){var t=leftover-primaryFit1;if(t>=p3*scale1){if(obj2)setFit(3,primaryPos,secondaryPos,t,secondaryLen)}else{newScale=leftover/(p1+p3)}}else{if(obj2)setFit(3,primaryPos,secondaryPos,leftover,secondaryLen)}}if(newScale!=0){if(obj1)setFit(1,primaryPos,secondaryPos,p1*newScale,secondaryLen);if(obj3)setFit(3,primaryPos,secondaryPos,p3*newScale,secondaryLen)}if(obj1)setFitPrimary(1,margin1*primary/100,primaryFit1);if(obj3)setFitPrimary(3,(margin1+margin2+margin3)*primary/100+primaryFit1+primaryFit2,primaryFit3);if(obj2)setFitPrimary(2,(margin1+margin2)*primary/100+primaryFit1,(100-margins)*primary/100-primaryFit1-primaryFit3)}function state3(){if(logStates){state=3;if(state!=lastState){zog("Flexive State "+state);lastState=state}}if(regionShape)regionShape.graphics.clear();backing.graphics.clear();if(backgroundColor!=-1)backing.graphics.f(backgroundColor).r(0,0,bounds.width,bounds.height);if(obj1&&!obj2&&!obj3){setFitPrimary(1,margin1*primary/100,primary-(margin1+margin4)*primary/100)}if(obj2&&!obj1&&!obj3){setFitPrimary(2,margin2*primary/100,primary-(margin2+margin4)*primary/100)}if(obj3&&!obj1&&!obj2){setFitPrimary(3,margin3*primary/100,primary-(margin3+margin4)*primary/100)}if(obj1&&obj3&&!obj2){newScale=(100-margin1-margin4-margin3)*primary/100/(p1+p3);f=setFitPrimary(1,margin1*primary/100,p1*newScale);setFitPrimary(3,(margin1+margin3)*primary/100+(vertical?f.h:f.w),p3*newScale)}if(obj1&&obj2&&!obj3){newScale=(100-margin1-margin4-margin2)*primary/100/(primaryFit1+primaryFit2);f=setFitPrimary(1,margin1*primary/100,primaryFit1*newScale);setFitPrimary(2,(margin1+margin2)*primary/100+(vertical?f.h:f.w),primaryFit2*newScale)}if(obj2&&obj3&&!obj1){newScale=(100-margin3-margin4-margin2)*primary/100/(primaryFit3+primaryFit2);f=setFitPrimary(2,margin2*primary/100,primaryFit2*newScale);setFitPrimary(3,(margin2+margin3)*primary/100+(vertical?f.h:f.w),primaryFit3*newScale)}if(obj1&&obj2&&obj3){leftover=(100-margins)*primary/100;f=setFitPrimary(1,margin1*primary/100,primaryFit1*leftover/(primaryFit1+primaryFit2+primaryFit3));f=setFitPrimary(2,(margin1+margin2)*primary/100+(vertical?f.h:f.w),primaryFit2*leftover/(primaryFit1+primaryFit2+primaryFit3));primaryLen=primaryFit3*leftover/(primaryFit1+primaryFit2+primaryFit3);primaryPos=primary-margin4*primary/100-primaryLen;f=setFitPrimary(3,primaryPos,primaryLen)}}function setFit(num,primaryPos,secondaryPos,primaryLen,secondaryLen){x=vertical?secondaryPos:primaryPos;y=vertical?primaryPos:secondaryPos;w=vertical?secondaryLen:primaryLen;h=vertical?primaryLen:secondaryLen;eval("fit"+num+" = zim.fit(obj"+num+",x,y,w,h);");eval("primaryFit"+num+" = (vertical) ? fit"+num+".height : fit"+num+".width;");eval("secondaryFit"+num+" = (vertical) ? fit"+num+".width : fit"+num+".height;");eval("scale"+num+" = fit"+num+".scale;");return{x:x,y:y,w:w,h:h}}function setFitPrimary(num,primaryPos,primaryLen){var colors=[null,"red","blue","green"];eval("secondaryPos = (100-max"+num+")/2*secondary/100;");eval("secondaryLen = max"+num+"*secondary/100;");eval("f = setFit("+num+",primaryPos,secondaryPos,primaryLen,secondaryLen);");var addedW=0;var addedH=0;if(primaryPos==0||primaryPos+primaryLen==primary)if(vertical){addedH=1}else{addedW=1}if(secondaryLen==secondary)if(vertical){addedW=1}else{addedH=1}eval("if (bg"+num+' != "") backing.graphics.f(bg'+num+").r(f.x, f.y, f.w+addedW, f.h+addedH);");eval('if (regionShape) regionShape.graphics.s("'+colors[num]+'").ss(2).dr(f.x, f.y, f.w, f.h);');eval("if (valign"+num+'=="top") obj'+num+".y = f.y;");eval("if (valign"+num+'=="bottom") obj'+num+".y = f.y+f.h-((vertical)?primaryFit"+num+":secondaryFit"+num+");");eval("if (align"+num+'=="left") obj'+num+".x = f.x - bounds.x;");eval("if (align"+num+'=="right") obj'+num+".x = f.x-bounds.x+f.w-((vertical)?secondaryFit"+num+":primaryFit"+num+");");return f}if(regionShape)regionShape.graphics.clear();backing.graphics.clear();if(backgroundColor!=-1)backing.graphics.f(backgroundColor).r(0,0,bounds.width,bounds.height);primary=vertical?bounds.height:bounds.width;secondary=vertical?bounds.width-bounds.x*2:bounds.height-bounds.y*2;var primaryFit1=0;var primaryFit2=0;var primaryFit3=0;var secondaryFit1=0;var secondaryFit2=0;var secondaryFit3=0;var scale1=0;var scale2=0;var scale3=0;primaryPos=0;secondaryPos=0;if(obj1){primaryLen=min1Start*primary/100;secondaryLen=max1*secondary/100;setFit(1,primaryPos,secondaryPos,primaryLen,secondaryLen);if(primaryFit1<min1Start*primary/100){min1=primaryFit1*100/primary;if(Math.floor(min1)!=Math.floor(min1Last)&&Math.floor(min1)!=Math.floor(min1Start)){if(zon)zog("zimbuild.js Layout(): region 1 min "+min1Start+"% cannot be met and will be set to "+Math.floor(min1)+"%");min1Last=min1}}}if(obj3){primaryLen=min3Start*primary/100;secondaryLen=max3*secondary/100;setFit(3,primaryPos,secondaryPos,primaryLen,secondaryLen);if(primaryFit3<min1Start*primary/100){min3=primaryFit3*100/primary;if(Math.floor(min3)!=Math.floor(min3Last)&&Math.floor(min3)!=Math.floor(min3Start)){if(zon)zog("zimbuild.js Layout(): region 3 min "+min3Start+"% cannot be met and will be set to "+Math.floor(min3)+"%");min3Last=min3}}}var p1=0;var p3=0;if(vertical){if(obj1)p1=obj1.getBounds().height;if(obj3)p3=obj3.getBounds().height}else{if(obj1)p1=obj1.getBounds().width;if(obj3)p3=obj3.getBounds().width}var leftover=(100-margins)*primary/100;var x;var y;var w;var h;var primaryPos;var primaryLen;var secondaryPosition;var secondaryLen;var newScale=0;var f;if(obj2){setFitPrimary(2,(margin1+min1+margin2)*primary/100,(100-(margins+min1+min3))*primary/100);if(Math.round(secondaryFit2)==Math.round(secondaryLen)){leftover=(100-margins-primaryFit2*100/primary)*primary/100;primaryPos=0;secondaryPos=0;primaryLen=1e4;if(obj1)setFit(1,primaryPos,secondaryPos,primaryLen,max1*secondary/100);if(obj3)setFit(3,primaryPos,secondaryPos,primaryLen,max3*secondary/100);if(primaryFit1+primaryFit3>leftover){state2()}else{state3()}}else{state1()}}else{state3()}if(!stage){for(var i=1;i<=3;i++)eval("if (obj"+i+" && obj"+i+".getStage()) stage = obj"+i+".getStage();")}if(stage)stage.update()}function assignVariables(i,vertical){if(vertical){if(eval("region"+i)){eval("obj"+i+"=region"+i+".object;");eval("margin"+i+"=(region"+i+".marginTop)?region"+i+".marginTop:0;");eval("max"+i+"=(region"+i+".maxWidth)?region"+i+".maxWidth:100;");if(i!=2){eval("min"+i+"=(region"+i+".minHeight)?region"+i+".minHeight:0;");eval("minAbs"+i+"=(region"+i+".height)?region"+i+".height:0;")}eval("if (region"+i+".align) align"+i+"=region"+i+".align;");eval("if (region"+i+".valign) valign"+i+"=region"+i+".valign;");eval("bg"+i+"=(region"+i+".backgroundColor)?region"+i+'.backgroundColor:"";')}}else{if(eval("region"+i)){eval("obj"+i+"=region"+i+".object;");eval("margin"+i+"=(region"+i+".marginLeft)?region"+i+".marginLeft:0;");eval("max"+i+"=(region"+i+".maxHeight)?region"+i+".maxHeight:100;");if(i!=2){eval("min"+i+"=(region"+i+".minWidth)?region"+i+".minWidth:0;");eval("minAbs"+i+"=(region"+i+".width)?region"+i+".width:0;")}eval("if (region"+i+".align) align"+i+"=region"+i+".align;");eval("if (region"+i+".valign) valign"+i+"=region"+i+".valign;");eval("bg"+i+"=(region"+i+".backgroundColor)?region"+i+'.backgroundColor:"";')}}eval("if (obj"+i+" && obj"+i+".getStage()) stage = obj"+i+".getStage();");eval("if (obj"+i+" && obj"+i+".getStage()) stage = obj"+i+".getStage();")}function keyEvent(e){if(!e)e=event;if(regionShape){if(e.keyCode==66){regionShape.visible=!regionShape.visible;if(regionShape.getStage())regionShape.getStage().update()}}}if(zot(holder)){zog("zimbuild.js Layout(): please provide an object with bounds set that holds the objects being laid out");return}scalingObject=zot(scalingObject)?holder:scalingObject;if(!scalingObject.getBounds()){zog("zimbuild.js Layout(): holder must have bounds set or provide a scalingObject with bounds");return}var bounds=scalingObject.getBounds();holder.setBounds(0,0,bounds.width,bounds.height);if(zot(lastMargin))lastMargin=0;if(zot(vertical))vertical=true;if(zot(backgroundColor))backgroundColor=-1;that=this;this.active=true;var logStates=false;var backing=new createjs.Shape;var obj1;var obj2;var obj3;var stage;var margin1=0;var margin2=0;var margin3=0;var margin4=zot(lastMargin)?0:lastMargin;var max1=0;var max2=0;var max3=0;var min1=0;var min3=0;var align1;var align2;var align3;var valign1;var valign2;var valign3;var bg1;var bg2;var bg3;var minAbs1;var minAbs3;var fit1={x:0,y:0,width:0,height:0,scale:0};var fit2={x:0,y:0,width:0,height:0,scale:0};var fit3={x:0,y:0,width:0,height:0,scale:0};var primary;var secondary;if(vertical){align1=align2=align3="middle";valign1="top";valign2="middle";valign3="bottom"}else{align1="left";align2="middle";align3="right";valign1=valign2=valign3="top"}for(var i=1;i<=3;i++)assignVariables(i,vertical);var margins=margin1+margin2+margin3+margin4;var min1Start=min1;var min3Start=min3;var min1Last=min1;var min3Last=min3;var state=0;var lastState=0;calculate();if(regionShape)holder.addChild(regionShape);holder.addChildAt(backing,0);this.resize=function(){if(!that.active)return;bounds=scalingObject.getBounds();holder.setBounds(0,0,bounds.width,bounds.height);calculate()};window.addEventListener("keydown",keyEvent);this.disable=function(){that.active=false;window.removeEventListener("keydown",keyEvent);if(regionShape)regionShape.alpha=0};this.enable=function(){that.active=true;window.addEventListener("keydown",keyEvent);that.resize=function(){bounds=scalingObject.getBounds();calculate()};if(regionShape)regionShape.alpha=1};this.removeShape=function(){if(regionShape){regionShape.graphics.clear();holder.removeChild(regionShape);regionShape=null;regionShape=false}window.removeEventListener("keydown",keyEvent)};this.addShape=function(e,t){that.removeShape();regionShape=e;regionTarget=t;window.addEventListener("keydown",keyEvent);holder.addChild(regionShape);that.resize()};this.dispose=function(){that.removeShape()}}makeLayout.prototype=new createjs.EventDispatcher;makeLayout.prototype.constructor=zim.Layout;return new makeLayout};zim.LayoutManager=function(){if(zon)zog("zimbuild.js: LayoutManager");var e=this;this.layouts=[];this.add=function(t){e.layouts.push(t)};this.resize=function(){for(var t=0;t<e.layouts.length;t++){e.layouts[t].resize()}};this.disable=function(){for(var t=0;t<e.layouts.length;t++){e.layouts[t].disable()}};this.enable=function(){for(var t=0;t<e.layouts.length;t++){e.layouts[t].enable()}};this.dispose=function(){for(var t=0;t<e.layouts.length;t++){e.layouts[t].removeShape()}}};return zim}(zim||{})